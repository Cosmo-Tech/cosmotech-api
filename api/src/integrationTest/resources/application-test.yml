management:
  endpoints:
    enabled-by-default: false

spring:
  data:
    redis:
      host: "localhost"
      username: "default"
      # Leave it as blank as there's no auth with test container
      password:
      client-type: jedis
  main:
    banner-mode: "off"
  cloud:
    aws:
      credentials:
        access-key: "s3_username"
        secret-key: "s3_password"
      s3:
        # We don't need/have a region for our local S3 service but the AWS SDKÂ requires one to be configured
        region: "dummy"
        # Enable path-style / disable DNS-style
        # By default, and for AWS S3, the client crafts its URL with the bucket as sub-domain of the endpoint
        # which is not how our current S3 implementation works as it expects the bucket in the path
        # '<bucket_name>.<endpoint>/<object_key>' DNS vs Path '<endpoint>/<bucket_name>/<object_key>'
        path-style-access-enabled: true
        endpoint: "http://localhost:9000"

csm:
  platform:
    containerRegistry:
      checkSolutionImage: false
    identityProvider:
      authorizationUrl: "http://fake_url:8080/authorize"
      tokenUrl: "http://fake_url:8080/token"
      containerScopes:
        '[https://api.cosmotech.com]': "Default scope"
      serverBaseUrl: "http://fake_url:8080"
      identity:
        clientId: "my_client_id"
        clientSecret: "my_client_secret"
        tenantId: "my_tenant_id"
      tls:
        enabled: false
        bundle: ""
    metrics:
      enabled: false
    api:
      # API Base Path for OpenAPI-generated controllers.
      # Might conflict with the SpringBoot context path, hence leaving it at the root
      base-path: /
      base-url: "http://fake_url:8080"
      version: latest
    event-publisher:
      type: in_process
    upload:
      authorized-mime-types:
        workspaces:
          - application/zip
          - application/xml
          - application/vnd.openxmlformats-officedocument.spreadsheetml.sheet
          - application/x-tika-ooxml
          - text/csv
          - text/plain
          - text/x-yaml
          - application/json
        datasets:
          - application/zip
          - application/xml
          - application/vnd.openxmlformats-officedocument.spreadsheetml.sheet
          - application/x-tika-ooxml
          - text/csv
          - text/plain
          - text/x-yaml
          - application/json
    authorization:
      mail-jwt-claim: "email"
      roles-jwt-claim: "userRoles"
      principal-jwt-claim: "email"
      application-id-jwt-claim: "sub"
      tenant-id-jwt-claim: "iss"
      # Note that the way @Value works in Spring does not make it possible to inject this sole YAML list.
      # Use CsmPlatformProperties instead !
      allowed-tenants: ["test"]
      allowedApiKeyConsumers:
        - name: "API Key for test controller as Platform Admin"
          apiKey: "PlatformAdminApiTestKeyValue"
          api-key-header-name: "user.admin@test.com"
          associated-role: "Platform.Admin"
          securedUris:
            - "/about"
            - "/organizations"
            - "/organizations/permissions"
            - "/organizations/.*"
            - "/organizations/.*/permissions/.*"
            - "/organizations/.*/security"
            - "/organizations/.*/security/access"
            - "/organizations/.*/security/access/.*"
            - "/organizations/.*/security/default"
            - "/organizations/.*/security/users"
            - "/organizations/.*/workspaces/.*/datasets"
            - "/organizations/.*/workspaces/.*/datasets/search"
            - "/organizations/.*/workspaces/.*/datasets/.*"
            - "/organizations/.*/workspaces/.*/datasets/.*/security"
            - "/organizations/.*/workspaces/.*/datasets/.*/security/access"
            - "/organizations/.*/workspaces/.*/datasets/.*/security/access/.*"
            - "/organizations/.*/workspaces/.*/datasets/.*/security/default"
            - "/organizations/.*/workspaces/.*/datasets/.*/security/users"
            - "/organizations/.*/workspaces/.*/datasets/.*/parts"
            - "/organizations/.*/workspaces/.*/datasets/.*/parts/search"
            - "/organizations/.*/workspaces/.*/datasets/.*/parts/.*"
            - "/organizations/.*/workspaces/.*/datasets/.*/parts/.*/download"
            - "/organizations/.*/workspaces/.*/datasets/.*/parts/.*/query"
            - "/organizations/.*/workspaces/.*/runners/.*/runs"
            - "/organizations/.*/workspaces/.*/runners/.*/runs/.*"
            - "/organizations/.*/workspaces/.*/runners/.*/runs/.*/data/query"
            - "/organizations/.*/workspaces/.*/runners/.*/runs/.*/data/send"
            - "/organizations/.*/workspaces/.*/runners/.*/runs/.*/logs"
            - "/organizations/.*/workspaces/.*/runners/.*/runs/.*/status"
            - "/organizations/.*/workspaces/.*/runners"
            - "/organizations/.*/workspaces/.*/runners/.*"
            - "/organizations/.*/workspaces/.*/runners/.*/permissions/.*"
            - "/organizations/.*/workspaces/.*/runners/.*/security"
            - "/organizations/.*/workspaces/.*/runners/.*/security/access"
            - "/organizations/.*/workspaces/.*/runners/.*/security/access/.*"
            - "/organizations/.*/workspaces/.*/runners/.*/security/default"
            - "/organizations/.*/workspaces/.*/runners/.*/security/users"
            - "/organizations/.*/workspaces/.*/runners/.*/start"
            - "/organizations/.*/workspaces/.*/runners/.*/stop"
            - "/organizations/.*/solutions"
            - "/organizations/.*/solutions/.*"
            - "/organizations/.*/solutions/.*/parameterGroups"
            - "/organizations/.*/solutions/.*/parameterGroups/.*"
            - "/organizations/.*/solutions/.*/parameters"
            - "/organizations/.*/solutions/.*/parameters/.*"
            - "/organizations/.*/solutions/.*/runTemplates"
            - "/organizations/.*/solutions/.*/runTemplates/.*"
            - "/organizations/.*/solutions/.*/security"
            - "/organizations/.*/solutions/.*/security/access"
            - "/organizations/.*/solutions/.*/security/access/.*"
            - "/organizations/.*/solutions/.*/security/default"
            - "/organizations/.*/solutions/.*/security/users"
            - "/organizations/.*/workspaces/.*/files"
            - "/organizations/.*/workspaces/.*/files/delete"
            - "/organizations/.*/workspaces/.*/files/download"
            - "/organizations/.*/workspaces"
            - "/organizations/.*/workspaces/.*"
            - "/organizations/.*/workspaces/.*/permissions/.*"
            - "/organizations/.*/workspaces/.*/security"
            - "/organizations/.*/workspaces/.*/security/access"
            - "/organizations/.*/workspaces/.*/security/access/.*"
            - "/organizations/.*/workspaces/.*/security/default"
            - "/organizations/.*/workspaces/.*/security/users"

        - name: "API Key for test controller as Organization User"
          apiKey: "OrganizationUserApiTestKeyValue"
          api-key-header-name: "user.org@test.com"
          associated-role: "Organization.User"
          securedUris:
            - "/organizations"
            - "/organizations/.*"
    argo:
      base-uri: "https://argo-server.argo.svc.cluster.local:2746"
      workflows:
        namespace: phoenix
        node-pool-label: ""
        service-account-name: workflowcsmv2
        storage-class: null
        access-modes:
          # Any in the following list: ReadWriteOnce, ReadOnlyMany, ReadWriteMany, ReadWriteOncePod (K8s 1.22+)
          - ReadWriteOnce
        requests:
          storage: 1Gi
    databases:
      resources:
        host: "localhost"
        port: "6379"
        username: "default"
        # Leave it as blank as there's no auth with test container
        password:
        tls:
          enabled: false
          bundle: ""
      data:
        database: "test"
        host: "localhost"
        port: 5432
        reader:
          password: "cosmotech_api_reader_pass"
          username: cosmotech_api_reader
        writer:
          password: "cosmotech_api_writer_pass"
          username: cosmotech_api_writer
    rbac:
      enabled: true
    s3:
      endpointUrl: "http://localhost:9000"
      bucketName: "test-bucket"
      accessKeyId: "s3_username"
      secretAccessKey: "s3_password"
      region: "dummy"


