{{- $baseConfig := include "cosmotech-api.baseConfig" . | fromYaml -}}
{{- $mergedConfig := mustMergeOverwrite (dict) .Values.config $baseConfig -}}
{{- $mergedConfigPlatformSensitiveInfo := get $mergedConfig "csm" -}}
kind: Secret
apiVersion: v1
metadata:
  name: {{ include "cosmotech-api.fullname" . }}
stringData:
  application-{{ .Values.config.csm.platform.vendor | lower }}.yml: |
    csm:
      {{- toYaml $mergedConfigPlatformSensitiveInfo | nindent 6 }}
